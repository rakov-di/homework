Вернуться на [главную](README.md)

> Приложение работает, НО имеется ряд вещей, которые планирую улучшить (см. [TODO](#todo)). 

## Содержание <a name = "content_table"></a>

- [Описание](#about)
- [Начало работы](#getting_started)
- [Структура файлов](#file_tree)
- [TODO](#todo)

## Описание <a name = "about"></a>

**На данный момент сделано**:
 - Созданы react-компоненты для css-блоков (css-стили разбиты по компонентам)
 - Подключено redux-хранилище
 - Страница `/` (или `/start-screen`):
    - При открытии происходит запрос за текущими настройками (во время выполнения запроса крутится лоадер). Если настройки есть - идет перенаправление на страницу `/build-history`, если их нет - открывается страница `/start-screen`. 
    - На странице `start-screen` по клику на кнопке `Open settings` или кнопке `Шестеренка` открывается страница `settings`.
 - Страница `/settings`
    - При открытии происходит запрос за ткущими настройками репозитория, если они есть - настройки вставляются в соответствующие поля формы.
    - В поле `Репозиорий` надо вводить название репозитория в формате `github_account/repo_name`, например: `rakov-di/homework_async`
    - Ограничена возможность ввода в поле `период` - только цифры.
    - При клике на кнопку `Save` происходит js-проверка заполнены ли обязательные поля.
    - Если поля заполнены - отправляется запрос на добавление/обновление настроек репозитория, на время выполнения запроса (в частности, при клонировании репозитория на сервере) кнопки на странице блокируются.
    
        > Время запроса ограничено (50 секунд), если репозиторий большой - он не успеет скопироваться, соединение оборвется с ошибкой превышения таймаута 
    - По завершении запроса выводится в форму выводится сообщение со статусом, сохранены ли настройки.   
    - При клике на кнопку `Cancel` - переход на страницу `start-screen` (если настройки уже есть - оттуда сразу перенаправляет на `build-history`).
 - Страница `/build-history`
    - При клике на карточку - переходит на страницу соответствующего билда `/build/{number}`
    - При клике на кнопку `Шестеренка` - переход на страницу `settings`.
    - При клике на кнопку `Run build` открывается модальное окно. 
    - Закрывается окно по клику на кнопку `Cancel`, на серую подложку вокруг или клавишей `Esc`. 
    - При клике по `Run build` в модальном окне происходит постановка введенного коммита (по `id` сборки) в очередь сборки и перенаправление на страницу `/build/{nimber}`. 
    - Если введенного хэша коммита нет в очереди сборок - показывается сообщение об ошибке в форме.
- Страница `/build/{number}` 
    - при клике на кнопку `Rebuild` происходит постановка текущего билда в очередь сборки, страница обновляется. Для каждого билда выводится раскрашенный лог-заглушка.
    - при клике на кнопку `Шестеренка` - переход на страницу `settings`

Для работы реакт-приложения использовались дополнительные пакеты:
- `date-fns` - форматирование даты/времени
- `ansi-to-html` - раскраска логов
- `axios` - для отправки запросов к серверу

Вернуться [К содержанию](#content_table)

## Начало работы <a name = "getting_started"></a>

Для запуска приложения необходимо:

### 1. Запустить NodeJS server

Посмотреть в [readme к домашке по node js](README-NODEJS.md#getting_started)

### 2. Запустить клиентское приложение React
- Зайти в папку [client](client)
- Запустить react-приложение из консоли
```CLI
npm start
```
- Доступ к приложению реализован через `http://localhost:3000`

Вернуться [К содержанию](#content_table)

## Структура файлов <a name = "file_tree"></a>

- [client](client) - папка с react приложением
    - [src](client/src) - исходники 
        - [index.ts](client/src/index.js) - точка входа в приложение
        - [App.js](client/src/App.js) - роутер по страницам приложения
        - [redux](client/src/redux) - папка с actions и reducers 
            - [actions](client/src/redux/actions) - папка с actions
                - [_consts.js](client/src/redux/actions/_consts.js) - текстовые константы для actions
                - [actions](client/src/redux/actions/actions) - сами actions
                - [api.js](client/src/redux/actions/api.js) - отдельно выведены методы для работы с api сервера
            - [reducers](client/src/redux/reducers) - папка с reducers
        - [pages](client/src/pages) - все страницы приложения
        - [components](client/src/components) - основные компоненты, из которых состоят страницы
        - [css](client/src/css) - общий css для всего приложения
        - [img](client/src/img) - спрайт с иконками

- [server](server) - папка с node js сервером

- [build](build), [src](src) - папки с версткой для первой домашки. Пока используются для контроля, что при переносе в react ничего не потерялось. По завершении домашки по react - перенести в архив.

Вернуться [К содержанию](#content_table)

## TODO

- Порефакторить redux (кое-где props все еще наследуются от родителей, а не от redux-store)
- Заменить Component на PureComponent где необходимо
- Доразделить стили для компонетов `Card` и `Icon` (для этого поменять принцип создания svg-спрайта с иконками)
- Поправить верстку карточки на странице `/build/{number}` 
- Для css-классов в компонентах подключить @bem-react/classname 
- Добавить обработчик на кнопку Show more на странице `/build-history`.
- Заменить stylus на sass (чтобы избавиться от cra eject) ??
- Проверить в коде не осталось ли незакрытых TODO

Вернуться [К содержанию](#content_table)

Вернуться на [главную](README.md)
